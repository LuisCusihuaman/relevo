-- ESQUEMA DE BASE DE DATOS RELEVO Y DATOS DE SEMILLA
-- Este archivo contiene todas las tablas y datos iniciales para la aplicaciÃ³n RELEVO
-- Ejecutar este script al configurar la base de datos Oracle por primera vez

-- ========================================
-- LIMPIAR TABLAS EXISTENTES (si existen)
-- ========================================

-- Eliminar tablas en orden inverso de dependencias (con manejo de errores)
DECLARE
    table_count NUMBER;
BEGIN
    -- Check and drop HANDOVER_CHECKLISTS
    SELECT COUNT(*) INTO table_count FROM USER_TABLES WHERE TABLE_NAME = 'HANDOVER_CHECKLISTS';
    IF table_count > 0 THEN
        EXECUTE IMMEDIATE 'DROP TABLE HANDOVER_CHECKLISTS CASCADE CONSTRAINTS';
    END IF;

    -- Check and drop HANDOVER_CONTINGENCY
    SELECT COUNT(*) INTO table_count FROM USER_TABLES WHERE TABLE_NAME = 'HANDOVER_CONTINGENCY';
    IF table_count > 0 THEN
        EXECUTE IMMEDIATE 'DROP TABLE HANDOVER_CONTINGENCY CASCADE CONSTRAINTS';
    END IF;

    -- Check and drop HANDOVER_MESSAGES
    SELECT COUNT(*) INTO table_count FROM USER_TABLES WHERE TABLE_NAME = 'HANDOVER_MESSAGES';
    IF table_count > 0 THEN
        EXECUTE IMMEDIATE 'DROP TABLE HANDOVER_MESSAGES CASCADE CONSTRAINTS';
    END IF;

    -- Check and drop HANDOVER_MENTIONS
    SELECT COUNT(*) INTO table_count FROM USER_TABLES WHERE TABLE_NAME = 'HANDOVER_MENTIONS';
    IF table_count > 0 THEN
        EXECUTE IMMEDIATE 'DROP TABLE HANDOVER_MENTIONS CASCADE CONSTRAINTS';
    END IF;

    -- Check and drop IPASS_TEMPLATES
    SELECT COUNT(*) INTO table_count FROM USER_TABLES WHERE TABLE_NAME = 'IPASS_TEMPLATES';
    IF table_count > 0 THEN
        EXECUTE IMMEDIATE 'DROP TABLE IPASS_TEMPLATES CASCADE CONSTRAINTS';
    END IF;

    -- Check and drop SECTION_TEMPLATES
    SELECT COUNT(*) INTO table_count FROM USER_TABLES WHERE TABLE_NAME = 'SECTION_TEMPLATES';
    IF table_count > 0 THEN
        EXECUTE IMMEDIATE 'DROP TABLE SECTION_TEMPLATES CASCADE CONSTRAINTS';
    END IF;

    -- Check and drop HANDOVER_ACTIVITY_LOG
    SELECT COUNT(*) INTO table_count FROM USER_TABLES WHERE TABLE_NAME = 'HANDOVER_ACTIVITY_LOG';
    IF table_count > 0 THEN
        EXECUTE IMMEDIATE 'DROP TABLE HANDOVER_ACTIVITY_LOG CASCADE CONSTRAINTS';
        END IF;
END;
/

DECLARE
    table_count NUMBER;
BEGIN
    -- Check and drop HANDOVER_ACTION_ITEMS
    SELECT COUNT(*) INTO table_count FROM USER_TABLES WHERE TABLE_NAME = 'HANDOVER_ACTION_ITEMS';
    IF table_count > 0 THEN
        EXECUTE IMMEDIATE 'DROP TABLE HANDOVER_ACTION_ITEMS CASCADE CONSTRAINTS';
    END IF;

    -- Check and drop HANDOVERS
    SELECT COUNT(*) INTO table_count FROM USER_TABLES WHERE TABLE_NAME = 'HANDOVERS';
    IF table_count > 0 THEN
    EXECUTE IMMEDIATE 'DROP TABLE HANDOVERS CASCADE CONSTRAINTS';
    END IF;

    -- Check and drop CONTRIBUTORS
    SELECT COUNT(*) INTO table_count FROM USER_TABLES WHERE TABLE_NAME = 'CONTRIBUTORS';
    IF table_count > 0 THEN
        EXECUTE IMMEDIATE 'DROP TABLE CONTRIBUTORS CASCADE CONSTRAINTS';
        END IF;
END;
/

DECLARE
    table_count NUMBER;
BEGIN
    -- Check and drop existing tables
    SELECT COUNT(*) INTO table_count FROM USER_TABLES WHERE TABLE_NAME = 'USER_SESSIONS';
    IF table_count > 0 THEN
        EXECUTE IMMEDIATE 'DROP TABLE USER_SESSIONS CASCADE CONSTRAINTS';
    END IF;

    SELECT COUNT(*) INTO table_count FROM USER_TABLES WHERE TABLE_NAME = 'USER_PREFERENCES';
    IF table_count > 0 THEN
        EXECUTE IMMEDIATE 'DROP TABLE USER_PREFERENCES CASCADE CONSTRAINTS';
    END IF;

    SELECT COUNT(*) INTO table_count FROM USER_TABLES WHERE TABLE_NAME = 'USER_ASSIGNMENTS';
    IF table_count > 0 THEN
        EXECUTE IMMEDIATE 'DROP TABLE USER_ASSIGNMENTS CASCADE CONSTRAINTS';
    END IF;

    SELECT COUNT(*) INTO table_count FROM USER_TABLES WHERE TABLE_NAME = 'HANDOVER_SYNC_STATUS';
    IF table_count > 0 THEN
        EXECUTE IMMEDIATE 'DROP TABLE HANDOVER_SYNC_STATUS CASCADE CONSTRAINTS';
    END IF;

    SELECT COUNT(*) INTO table_count FROM USER_TABLES WHERE TABLE_NAME = 'HANDOVER_SECTIONS';
    IF table_count > 0 THEN
        EXECUTE IMMEDIATE 'DROP TABLE HANDOVER_SECTIONS CASCADE CONSTRAINTS';
    END IF;

    SELECT COUNT(*) INTO table_count FROM USER_TABLES WHERE TABLE_NAME = 'HANDOVER_PARTICIPANTS';
    IF table_count > 0 THEN
        EXECUTE IMMEDIATE 'DROP TABLE HANDOVER_PARTICIPANTS CASCADE CONSTRAINTS';
    END IF;

    SELECT COUNT(*) INTO table_count FROM USER_TABLES WHERE TABLE_NAME = 'USERS';
    IF table_count > 0 THEN
        EXECUTE IMMEDIATE 'DROP TABLE USERS CASCADE CONSTRAINTS';
    END IF;

    SELECT COUNT(*) INTO table_count FROM USER_TABLES WHERE TABLE_NAME = 'PATIENTS';
    IF table_count > 0 THEN
        EXECUTE IMMEDIATE 'DROP TABLE PATIENTS CASCADE CONSTRAINTS';
    END IF;

    SELECT COUNT(*) INTO table_count FROM USER_TABLES WHERE TABLE_NAME = 'SHIFTS';
    IF table_count > 0 THEN
        EXECUTE IMMEDIATE 'DROP TABLE SHIFTS CASCADE CONSTRAINTS';
    END IF;

    SELECT COUNT(*) INTO table_count FROM USER_TABLES WHERE TABLE_NAME = 'UNITS';
    IF table_count > 0 THEN
        EXECUTE IMMEDIATE 'DROP TABLE UNITS CASCADE CONSTRAINTS';
        END IF;
END;
/

BEGIN
    EXECUTE IMMEDIATE 'DROP SEQUENCE CONTRIBUTORS_SEQ';
EXCEPTION
    WHEN OTHERS THEN
        IF SQLCODE != -2289 THEN
            RAISE;
        END IF;
END;
/

BEGIN
    EXECUTE IMMEDIATE 'DROP TABLE PATIENTS CASCADE CONSTRAINTS';
EXCEPTION
    WHEN OTHERS THEN
        IF SQLCODE != -942 THEN
            RAISE;
        END IF;
END;
/

BEGIN
    EXECUTE IMMEDIATE 'DROP TABLE SHIFTS CASCADE CONSTRAINTS';
EXCEPTION
    WHEN OTHERS THEN
        IF SQLCODE != -942 THEN
            RAISE;
        END IF;
END;
/

BEGIN
    EXECUTE IMMEDIATE 'DROP TABLE UNITS CASCADE CONSTRAINTS';
EXCEPTION
    WHEN OTHERS THEN
        IF SQLCODE != -942 THEN
            RAISE;
        END IF;
END;
/

-- ========================================
-- CREAR TABLAS
-- ========================================

-- Tabla UNITS
CREATE TABLE UNITS (
    ID VARCHAR2(50) PRIMARY KEY,
    NAME VARCHAR2(100) NOT NULL,
    DESCRIPTION VARCHAR2(500),
    CREATED_AT TIMESTAMP DEFAULT SYSTIMESTAMP,
    UPDATED_AT TIMESTAMP DEFAULT SYSTIMESTAMP
);

-- Tabla SHIFTS
CREATE TABLE SHIFTS (
    ID VARCHAR2(50) PRIMARY KEY,
    NAME VARCHAR2(100) NOT NULL,
    START_TIME VARCHAR2(5) NOT NULL, -- Format: HH:MM
    END_TIME VARCHAR2(5) NOT NULL,   -- Format: HH:MM
    CREATED_AT TIMESTAMP DEFAULT SYSTIMESTAMP,
    UPDATED_AT TIMESTAMP DEFAULT SYSTIMESTAMP
);

-- Tabla PATIENTS
CREATE TABLE PATIENTS (
    ID VARCHAR2(50) PRIMARY KEY,
    NAME VARCHAR2(200) NOT NULL,
    UNIT_ID VARCHAR2(50) NOT NULL,
    DATE_OF_BIRTH DATE,
    GENDER VARCHAR2(20), -- Male, Female, Other, Unknown
    ADMISSION_DATE TIMESTAMP,
    ROOM_NUMBER VARCHAR2(20),
    DIAGNOSIS VARCHAR2(500),
    ALLERGIES VARCHAR2(1000),
    MEDICATIONS VARCHAR2(1000),
    NOTES VARCHAR2(1000),
    CREATED_AT TIMESTAMP DEFAULT SYSTIMESTAMP,
    UPDATED_AT TIMESTAMP DEFAULT SYSTIMESTAMP,
    CONSTRAINT FK_PATIENTS_UNIT FOREIGN KEY (UNIT_ID) REFERENCES UNITS(ID)
);

-- Tabla USER_ASSIGNMENTS (para asignaciones de pacientes a usuarios)
CREATE TABLE USER_ASSIGNMENTS (
    ASSIGNMENT_ID VARCHAR2(255) PRIMARY KEY,
    USER_ID VARCHAR2(255) NOT NULL,
    SHIFT_ID VARCHAR2(50) NOT NULL,
    PATIENT_ID VARCHAR2(50) NOT NULL,
    ASSIGNED_AT TIMESTAMP DEFAULT SYSTIMESTAMP,
    CONSTRAINT FK_ASSIGNMENTS_PATIENT FOREIGN KEY (PATIENT_ID) REFERENCES PATIENTS(ID),
    CONSTRAINT FK_ASSIGNMENTS_SHIFT FOREIGN KEY (SHIFT_ID) REFERENCES SHIFTS(ID)
);

-- Tabla CONTRIBUTORS (para funcionalidad existente)
CREATE TABLE CONTRIBUTORS (
    ID NUMBER PRIMARY KEY,
    NAME VARCHAR2(200) NOT NULL,
    EMAIL VARCHAR2(200) NOT NULL,
    PHONE_NUMBER VARCHAR2(20),
    CREATED_AT TIMESTAMP DEFAULT SYSTIMESTAMP,
    UPDATED_AT TIMESTAMP DEFAULT SYSTIMESTAMP
);

-- Sequence para CONTRIBUTORS (Oracle 11g compatible)
CREATE SEQUENCE CONTRIBUTORS_SEQ START WITH 1 INCREMENT BY 1;

-- Trigger para auto-incrementar ID en CONTRIBUTORS
CREATE OR REPLACE TRIGGER CONTRIBUTORS_TRG
BEFORE INSERT ON CONTRIBUTORS
FOR EACH ROW
WHEN (NEW.ID IS NULL)
BEGIN
    SELECT CONTRIBUTORS_SEQ.NEXTVAL INTO :NEW.ID FROM DUAL;
END;
/

-- Tabla HANDOVERS
CREATE TABLE HANDOVERS (
    ID VARCHAR2(50) PRIMARY KEY,
    ASSIGNMENT_ID VARCHAR2(255) NOT NULL, -- FK a USER_ASSIGNMENTS
    PATIENT_ID VARCHAR2(50) NOT NULL,
    STATUS VARCHAR2(20) NOT NULL, -- Active, InProgress, Completed, Cancelled
    ILLNESS_SEVERITY VARCHAR2(20), -- Stable, Watcher, Unstable, Critical
    PATIENT_SUMMARY CLOB,
    SITUATION_AWARENESS_DOC_ID VARCHAR2(100),
    SYNTHESIS CLOB,
    CREATED_AT TIMESTAMP DEFAULT SYSTIMESTAMP,
    UPDATED_AT TIMESTAMP DEFAULT SYSTIMESTAMP,
    COMPLETED_AT TIMESTAMP,
    SHIFT_NAME VARCHAR2(100),
    FROM_SHIFT_ID VARCHAR2(50), -- Shift being handed over FROM
    TO_SHIFT_ID VARCHAR2(50), -- Shift receiving the handover TO
    FROM_DOCTOR_ID VARCHAR2(255), -- Doctor handing over (Clerk User ID)
    TO_DOCTOR_ID VARCHAR2(255), -- Doctor receiving handover (Clerk User ID)
    CREATED_BY VARCHAR2(255), -- Clerk User ID who initiated
    INITIATED_AT TIMESTAMP DEFAULT SYSTIMESTAMP, -- When handover was initiated
    ACCEPTED_AT TIMESTAMP, -- When receiving doctor accepted
    COMPLETED_BY VARCHAR2(255), -- Who completed the handover
    CONSTRAINT FK_HANDOVERS_ASSIGNMENT FOREIGN KEY (ASSIGNMENT_ID) REFERENCES USER_ASSIGNMENTS(ASSIGNMENT_ID),
    CONSTRAINT FK_HANDOVERS_PATIENT FOREIGN KEY (PATIENT_ID) REFERENCES PATIENTS(ID),
    CONSTRAINT FK_HANDOVERS_FROM_SHIFT FOREIGN KEY (FROM_SHIFT_ID) REFERENCES SHIFTS(ID),
    CONSTRAINT FK_HANDOVERS_TO_SHIFT FOREIGN KEY (TO_SHIFT_ID) REFERENCES SHIFTS(ID)
);

-- Tabla HANDOVER_ACTION_ITEMS
CREATE TABLE HANDOVER_ACTION_ITEMS (
    ID VARCHAR2(50) PRIMARY KEY,
    HANDOVER_ID VARCHAR2(50) NOT NULL,
    DESCRIPTION VARCHAR2(500) NOT NULL,
    IS_COMPLETED NUMBER(1) DEFAULT 0, -- 0 = false, 1 = true
    CREATED_AT TIMESTAMP DEFAULT SYSTIMESTAMP,
    UPDATED_AT TIMESTAMP DEFAULT SYSTIMESTAMP,
    COMPLETED_AT TIMESTAMP,
    CONSTRAINT FK_ACTION_ITEMS_HANDOVER FOREIGN KEY (HANDOVER_ID) REFERENCES HANDOVERS(ID)
);

-- Tabla HANDOVER_PARTICIPANTS (participantes activos en un handover)
CREATE TABLE HANDOVER_PARTICIPANTS (
    ID VARCHAR2(50) PRIMARY KEY,
    HANDOVER_ID VARCHAR2(50) NOT NULL,
    USER_ID VARCHAR2(255) NOT NULL, -- Clerk User ID
    USER_NAME VARCHAR2(200) NOT NULL,
    USER_ROLE VARCHAR2(100),
    STATUS VARCHAR2(20) DEFAULT 'active', -- active, inactive, viewing
    JOINED_AT TIMESTAMP DEFAULT SYSTIMESTAMP,
    LAST_ACTIVITY TIMESTAMP DEFAULT SYSTIMESTAMP,
    CONSTRAINT FK_PARTICIPANTS_HANDOVER FOREIGN KEY (HANDOVER_ID) REFERENCES HANDOVERS(ID)
);

-- Tabla HANDOVER_SECTIONS (secciones I-PASS individuales)
CREATE TABLE HANDOVER_SECTIONS (
    ID VARCHAR2(50) PRIMARY KEY,
    HANDOVER_ID VARCHAR2(50) NOT NULL,
    SECTION_TYPE VARCHAR2(20) NOT NULL, -- illness_severity, patient_summary, action_items, situation_awareness, synthesis
    CONTENT CLOB,
    STATUS VARCHAR2(20) DEFAULT 'draft', -- draft, in_progress, completed
    LAST_EDITED_BY VARCHAR2(255), -- Clerk User ID
    CREATED_AT TIMESTAMP DEFAULT SYSTIMESTAMP,
    UPDATED_AT TIMESTAMP DEFAULT SYSTIMESTAMP,
    CONSTRAINT FK_SECTIONS_HANDOVER FOREIGN KEY (HANDOVER_ID) REFERENCES HANDOVERS(ID)
);

-- Tabla SYNC_STATUS (estado de sincronizaciÃ³n del handover)
CREATE TABLE HANDOVER_SYNC_STATUS (
    ID VARCHAR2(50) PRIMARY KEY,
    HANDOVER_ID VARCHAR2(50) NOT NULL,
    USER_ID VARCHAR2(255) NOT NULL, -- Clerk User ID
    SYNC_STATUS VARCHAR2(20) DEFAULT 'synced', -- synced, syncing, pending, offline, error
    LAST_SYNC TIMESTAMP DEFAULT SYSTIMESTAMP,
    VERSION NUMBER DEFAULT 1,
    CONSTRAINT FK_SYNC_HANDOVER FOREIGN KEY (HANDOVER_ID) REFERENCES HANDOVERS(ID),
    CONSTRAINT UK_SYNC_USER_HANDOVER UNIQUE (HANDOVER_ID, USER_ID)
);

-- Tabla USERS (informaciÃ³n de usuarios de Clerk)
CREATE TABLE USERS (
    ID VARCHAR2(255) PRIMARY KEY, -- Clerk User ID
    EMAIL VARCHAR2(200) NOT NULL,
    FIRST_NAME VARCHAR2(100),
    LAST_NAME VARCHAR2(100),
    FULL_NAME VARCHAR2(200),
    AVATAR_URL VARCHAR2(500),
    ROLE VARCHAR2(50) DEFAULT 'user', -- admin, doctor, nurse, etc.
    IS_ACTIVE NUMBER(1) DEFAULT 1,
    LAST_LOGIN TIMESTAMP,
    CREATED_AT TIMESTAMP DEFAULT SYSTIMESTAMP,
    UPDATED_AT TIMESTAMP DEFAULT SYSTIMESTAMP
);

-- Add foreign key constraints for HANDOVERS table (after USERS table is created)
ALTER TABLE HANDOVERS ADD CONSTRAINT FK_HANDOVERS_FROM_DOCTOR FOREIGN KEY (FROM_DOCTOR_ID) REFERENCES USERS(ID);
ALTER TABLE HANDOVERS ADD CONSTRAINT FK_HANDOVERS_TO_DOCTOR FOREIGN KEY (TO_DOCTOR_ID) REFERENCES USERS(ID);
ALTER TABLE HANDOVERS ADD CONSTRAINT FK_HANDOVERS_COMPLETED_BY FOREIGN KEY (COMPLETED_BY) REFERENCES USERS(ID);

-- Tabla USER_PREFERENCES (preferencias de usuario)
CREATE TABLE USER_PREFERENCES (
    ID VARCHAR2(50) PRIMARY KEY,
    USER_ID VARCHAR2(255) NOT NULL,
    THEME VARCHAR2(20) DEFAULT 'light',
    LANGUAGE VARCHAR2(10) DEFAULT 'en',
    TIMEZONE VARCHAR2(50) DEFAULT 'UTC',
    NOTIFICATIONS_ENABLED NUMBER(1) DEFAULT 1,
    AUTO_SAVE_ENABLED NUMBER(1) DEFAULT 1,
    CREATED_AT TIMESTAMP DEFAULT SYSTIMESTAMP,
    UPDATED_AT TIMESTAMP DEFAULT SYSTIMESTAMP,
    CONSTRAINT FK_USER_PREFERENCES_USER FOREIGN KEY (USER_ID) REFERENCES USERS(ID)
);

-- Tabla USER_SESSIONS (sesiones activas de usuario)
CREATE TABLE USER_SESSIONS (
    ID VARCHAR2(50) PRIMARY KEY,
    USER_ID VARCHAR2(255) NOT NULL,
    SESSION_START TIMESTAMP DEFAULT SYSTIMESTAMP,
    SESSION_END TIMESTAMP,
    IP_ADDRESS VARCHAR2(45),
    USER_AGENT VARCHAR2(500),
    IS_ACTIVE NUMBER(1) DEFAULT 1,
    CONSTRAINT FK_USER_SESSIONS_USER FOREIGN KEY (USER_ID) REFERENCES USERS(ID)
);

-- Tabla HANDOVER_CHECKLISTS (listas de verificaciÃ³n para sÃ­ntesis)
CREATE TABLE HANDOVER_CHECKLISTS (
    ID VARCHAR2(50) PRIMARY KEY,
    HANDOVER_ID VARCHAR2(50) NOT NULL,
    USER_ID VARCHAR2(255) NOT NULL,
    ITEM_ID VARCHAR2(100) NOT NULL,
    ITEM_CATEGORY VARCHAR2(100),
    ITEM_LABEL VARCHAR2(500),
    ITEM_DESCRIPTION VARCHAR2(1000),
    IS_REQUIRED NUMBER(1) DEFAULT 0,
    IS_CHECKED NUMBER(1) DEFAULT 0,
    CHECKED_AT TIMESTAMP,
    CREATED_AT TIMESTAMP DEFAULT SYSTIMESTAMP,
    UPDATED_AT TIMESTAMP DEFAULT SYSTIMESTAMP,
    CONSTRAINT FK_CHECKLIST_HANDOVER FOREIGN KEY (HANDOVER_ID) REFERENCES HANDOVERS(ID),
    CONSTRAINT FK_CHECKLIST_USER FOREIGN KEY (USER_ID) REFERENCES USERS(ID),
    CONSTRAINT UK_CHECKLIST_ITEM UNIQUE (HANDOVER_ID, USER_ID, ITEM_ID)
);

-- Tabla HANDOVER_CONTINGENCY (planes de contingencia)
CREATE TABLE HANDOVER_CONTINGENCY (
    ID VARCHAR2(50) PRIMARY KEY,
    HANDOVER_ID VARCHAR2(50) NOT NULL,
    CONDITION_TEXT VARCHAR2(1000) NOT NULL,
    ACTION_TEXT VARCHAR2(1000) NOT NULL,
    PRIORITY VARCHAR2(20) DEFAULT 'medium', -- low, medium, high
    STATUS VARCHAR2(20) DEFAULT 'active', -- active, planned, completed
    CREATED_BY VARCHAR2(255) NOT NULL,
    CREATED_AT TIMESTAMP DEFAULT SYSTIMESTAMP,
    UPDATED_AT TIMESTAMP DEFAULT SYSTIMESTAMP,
    CONSTRAINT FK_CONTINGENCY_HANDOVER FOREIGN KEY (HANDOVER_ID) REFERENCES HANDOVERS(ID),
    CONSTRAINT FK_CONTINGENCY_USER FOREIGN KEY (CREATED_BY) REFERENCES USERS(ID)
);

-- Tabla HANDOVER_MESSAGES (mensajes de discusiÃ³n)
CREATE TABLE HANDOVER_MESSAGES (
    ID VARCHAR2(50) PRIMARY KEY,
    HANDOVER_ID VARCHAR2(50) NOT NULL,
    USER_ID VARCHAR2(255) NOT NULL,
    MESSAGE_TEXT CLOB NOT NULL,
    MESSAGE_TYPE VARCHAR2(20) DEFAULT 'message', -- message, system, notification
    CREATED_AT TIMESTAMP DEFAULT SYSTIMESTAMP,
    UPDATED_AT TIMESTAMP DEFAULT SYSTIMESTAMP,
    CONSTRAINT FK_DISCUSSION_HANDOVER FOREIGN KEY (HANDOVER_ID) REFERENCES HANDOVERS(ID),
    CONSTRAINT FK_DISCUSSION_USER FOREIGN KEY (USER_ID) REFERENCES USERS(ID)
);

-- Tabla HANDOVER_MENTIONS (menciones en mensajes)
CREATE TABLE HANDOVER_MENTIONS (
    ID VARCHAR2(50) PRIMARY KEY,
    MESSAGE_ID VARCHAR2(50) NOT NULL,
    MENTIONED_USER_ID VARCHAR2(255) NOT NULL,
    CREATED_AT TIMESTAMP DEFAULT SYSTIMESTAMP,
    CONSTRAINT FK_MENTION_MESSAGE FOREIGN KEY (MESSAGE_ID) REFERENCES HANDOVER_MESSAGES(ID),
    CONSTRAINT FK_MENTION_USER FOREIGN KEY (MENTIONED_USER_ID) REFERENCES USERS(ID)
);

-- Tabla IPASS_TEMPLATES (plantillas I-PASS)
CREATE TABLE IPASS_TEMPLATES (
    ID VARCHAR2(50) PRIMARY KEY,
    TEMPLATE_ID VARCHAR2(100) NOT NULL,
    SECTION VARCHAR2(50) NOT NULL, -- illness, patient, actions, awareness, synthesis
    TITLE VARCHAR2(200) NOT NULL,
    TEMPLATE_CONTENT CLOB NOT NULL,
    IS_ACTIVE NUMBER(1) DEFAULT 1,
    CREATED_AT TIMESTAMP DEFAULT SYSTIMESTAMP,
    UPDATED_AT TIMESTAMP DEFAULT SYSTIMESTAMP,
    CONSTRAINT UK_TEMPLATE_ID UNIQUE (TEMPLATE_ID)
);

-- Tabla SECTION_TEMPLATES (plantillas de secciones)
CREATE TABLE SECTION_TEMPLATES (
    ID VARCHAR2(50) PRIMARY KEY,
    SECTION_TYPE VARCHAR2(50) NOT NULL, -- patient_summary, situation_awareness, synthesis
    TEMPLATE_NAME VARCHAR2(200) NOT NULL,
    TEMPLATE_CONTENT CLOB NOT NULL,
    IS_DEFAULT NUMBER(1) DEFAULT 0,
    CREATED_AT TIMESTAMP DEFAULT SYSTIMESTAMP,
    UPDATED_AT TIMESTAMP DEFAULT SYSTIMESTAMP
);

-- Tabla HANDOVER_ACTIVITY_LOG (registro de actividades)
CREATE TABLE HANDOVER_ACTIVITY_LOG (
    ID VARCHAR2(50) PRIMARY KEY,
    HANDOVER_ID VARCHAR2(50),
    USER_ID VARCHAR2(255),
    ACTIVITY_TYPE VARCHAR2(100) NOT NULL, -- edited_section, added_action_item, sent_message, etc.
    ACTIVITY_DESCRIPTION VARCHAR2(500),
    SECTION_AFFECTED VARCHAR2(50),
    METADATA CLOB, -- JSON with additional activity data
    CREATED_AT TIMESTAMP DEFAULT SYSTIMESTAMP,
    CONSTRAINT FK_ACTIVITY_HANDOVER FOREIGN KEY (HANDOVER_ID) REFERENCES HANDOVERS(ID),
    CONSTRAINT FK_ACTIVITY_USER FOREIGN KEY (USER_ID) REFERENCES USERS(ID)
);

-- ========================================
-- CREAR ÃNDICES
-- ========================================

CREATE INDEX IDX_PATIENTS_UNIT_ID ON PATIENTS(UNIT_ID);
CREATE INDEX IDX_USER_ASSIGNMENTS_USER ON USER_ASSIGNMENTS(USER_ID);
CREATE INDEX IDX_USER_ASSIGNMENTS_PATIENT ON USER_ASSIGNMENTS(PATIENT_ID);
CREATE INDEX IDX_USER_ASSIGNMENTS_SHIFT ON USER_ASSIGNMENTS(SHIFT_ID);
CREATE INDEX IDX_HANDOVERS_PATIENT_ID ON HANDOVERS(PATIENT_ID);
CREATE INDEX IDX_HANDOVERS_ASSIGNMENT_ID ON HANDOVERS(ASSIGNMENT_ID);
CREATE INDEX IDX_HANDOVERS_STATUS ON HANDOVERS(STATUS);
CREATE INDEX IDX_HANDOVERS_CREATED_BY ON HANDOVERS(CREATED_BY);
CREATE INDEX IDX_HANDOVERS_FROM_DOCTOR ON HANDOVERS(FROM_DOCTOR_ID);
CREATE INDEX IDX_HANDOVERS_TO_DOCTOR ON HANDOVERS(TO_DOCTOR_ID);
CREATE INDEX IDX_HANDOVERS_FROM_SHIFT ON HANDOVERS(FROM_SHIFT_ID);
CREATE INDEX IDX_HANDOVERS_TO_SHIFT ON HANDOVERS(TO_SHIFT_ID);
CREATE INDEX IDX_HANDOVERS_INITIATED_AT ON HANDOVERS(INITIATED_AT);
CREATE INDEX IDX_HANDOVERS_COMPLETED_AT ON HANDOVERS(COMPLETED_AT);
CREATE INDEX IDX_HACTION_HANDOVER_ID ON HANDOVER_ACTION_ITEMS(HANDOVER_ID);
CREATE INDEX IDX_PARTICIPANTS_HANDOVER_ID ON HANDOVER_PARTICIPANTS(HANDOVER_ID);
CREATE INDEX IDX_PARTICIPANTS_USER_ID ON HANDOVER_PARTICIPANTS(USER_ID);
CREATE INDEX IDX_PARTICIPANTS_STATUS ON HANDOVER_PARTICIPANTS(STATUS);
CREATE INDEX IDX_SECTIONS_HANDOVER_ID ON HANDOVER_SECTIONS(HANDOVER_ID);
CREATE INDEX IDX_SECTIONS_TYPE ON HANDOVER_SECTIONS(SECTION_TYPE);
CREATE INDEX IDX_SECTIONS_STATUS ON HANDOVER_SECTIONS(STATUS);
CREATE INDEX IDX_SYNC_HANDOVER_ID ON HANDOVER_SYNC_STATUS(HANDOVER_ID);
CREATE INDEX IDX_SYNC_USER_ID ON HANDOVER_SYNC_STATUS(USER_ID);
CREATE INDEX IDX_SYNC_STATUS ON HANDOVER_SYNC_STATUS(SYNC_STATUS);
CREATE INDEX IDX_USERS_EMAIL ON USERS(EMAIL);
CREATE INDEX IDX_USERS_ROLE ON USERS(ROLE);
CREATE INDEX IDX_USERS_IS_ACTIVE ON USERS(IS_ACTIVE);
CREATE INDEX IDX_USER_PREFERENCES_USER_ID ON USER_PREFERENCES(USER_ID);
CREATE INDEX IDX_USER_SESSIONS_USER_ID ON USER_SESSIONS(USER_ID);
CREATE INDEX IDX_USER_SESSIONS_ACTIVE ON USER_SESSIONS(IS_ACTIVE);
CREATE INDEX IDX_CHECKLIST_HANDOVER ON HANDOVER_CHECKLISTS(HANDOVER_ID);
CREATE INDEX IDX_CHECKLIST_USER ON HANDOVER_CHECKLISTS(USER_ID);
CREATE INDEX IDX_CHECKLIST_ITEM ON HANDOVER_CHECKLISTS(ITEM_ID);
CREATE INDEX IDX_CHECKLIST_CHECKED ON HANDOVER_CHECKLISTS(IS_CHECKED);
CREATE INDEX IDX_CONTINGENCY_HANDOVER ON HANDOVER_CONTINGENCY(HANDOVER_ID);
CREATE INDEX IDX_CONTINGENCY_USER ON HANDOVER_CONTINGENCY(CREATED_BY);
CREATE INDEX IDX_CONTINGENCY_STATUS ON HANDOVER_CONTINGENCY(STATUS);
CREATE INDEX IDX_DISCUSSION_HANDOVER ON HANDOVER_MESSAGES(HANDOVER_ID);
CREATE INDEX IDX_DISCUSSION_USER ON HANDOVER_MESSAGES(USER_ID);
CREATE INDEX IDX_DISCUSSION_TYPE ON HANDOVER_MESSAGES(MESSAGE_TYPE);
CREATE INDEX IDX_DISCUSSION_CREATED ON HANDOVER_MESSAGES(CREATED_AT);
CREATE INDEX IDX_MENTION_MESSAGE ON HANDOVER_MENTIONS(MESSAGE_ID);
CREATE INDEX IDX_MENTION_USER ON HANDOVER_MENTIONS(MENTIONED_USER_ID);
-- Note: IDX_IPASS_TEMPLATE_ID index not needed as UK_TEMPLATE_ID unique constraint creates it automatically
CREATE INDEX IDX_IPASS_SECTION ON IPASS_TEMPLATES(SECTION);
CREATE INDEX IDX_IPASS_ACTIVE ON IPASS_TEMPLATES(IS_ACTIVE);
CREATE INDEX IDX_SECTION_TEMPLATE_TYPE ON SECTION_TEMPLATES(SECTION_TYPE);
CREATE INDEX IDX_SECTION_TEMPLATE_DEFAULT ON SECTION_TEMPLATES(IS_DEFAULT);
CREATE INDEX IDX_ACTIVITY_HANDOVER ON HANDOVER_ACTIVITY_LOG(HANDOVER_ID);
CREATE INDEX IDX_ACTIVITY_USER ON HANDOVER_ACTIVITY_LOG(USER_ID);
CREATE INDEX IDX_ACTIVITY_TYPE ON HANDOVER_ACTIVITY_LOG(ACTIVITY_TYPE);
CREATE INDEX IDX_ACTIVITY_CREATED ON HANDOVER_ACTIVITY_LOG(CREATED_AT);

-- ========================================
-- INSERTAR DATOS DE SEMILLA
-- ========================================

-- Insertar Unidades
INSERT INTO UNITS (ID, NAME, DESCRIPTION) VALUES ('unit-1', 'UCI', 'Unidad de Cuidados Intensivos');
INSERT INTO UNITS (ID, NAME, DESCRIPTION) VALUES ('unit-2', 'PediatrÃ­a General', 'Unidad de PediatrÃ­a General');
INSERT INTO UNITS (ID, NAME, DESCRIPTION) VALUES ('unit-3', 'PediatrÃ­a Especializada', 'Unidad de PediatrÃ­a Especializada');

-- Insertar Turnos
INSERT INTO SHIFTS (ID, NAME, START_TIME, END_TIME) VALUES ('shift-day', 'MaÃ±ana', '07:00', '15:00');
INSERT INTO SHIFTS (ID, NAME, START_TIME, END_TIME) VALUES ('shift-night', 'Noche', '19:00', '07:00');

-- Insertar Pacientes para Unidad 1 (UCI) - 12 pacientes
INSERT INTO PATIENTS (ID, NAME, UNIT_ID, DATE_OF_BIRTH, GENDER, ADMISSION_DATE, ROOM_NUMBER, DIAGNOSIS, ALLERGIES, MEDICATIONS, NOTES)
VALUES ('pat-001', 'MarÃ­a GarcÃ­a', 'unit-1', TO_DATE('2010-03-15', 'YYYY-MM-DD'), 'Female', SYSTIMESTAMP - 3, '201', 'NeumonÃ­a adquirida en comunidad', 'Penicilina', 'Amoxicilina, OxÃ­geno suplementario', 'Paciente estable, saturaciÃ³n de oxÃ­geno 94%, requiere nebulizaciones cada 6 horas');

INSERT INTO PATIENTS (ID, NAME, UNIT_ID, DATE_OF_BIRTH, GENDER, ADMISSION_DATE, ROOM_NUMBER, DIAGNOSIS, ALLERGIES, MEDICATIONS, NOTES)
VALUES ('pat-002', 'Carlos RodrÃ­guez', 'unit-1', TO_DATE('2008-07-22', 'YYYY-MM-DD'), 'Male', SYSTIMESTAMP - 5, '202', 'Sepsis secundaria a infecciÃ³n urinaria', 'Sulfonamidas', 'Meropenem, Vasopresores', 'Paciente crÃ­tico, requiere monitoreo continuo de signos vitales y soporte hemodinÃ¡mico');

INSERT INTO PATIENTS (ID, NAME, UNIT_ID, DATE_OF_BIRTH, GENDER, ADMISSION_DATE, ROOM_NUMBER, DIAGNOSIS, ALLERGIES, MEDICATIONS, NOTES)
VALUES ('pat-003', 'Ana LÃ³pez', 'unit-1', TO_DATE('2012-11-08', 'YYYY-MM-DD'), 'Female', SYSTIMESTAMP - 2, '203', 'Estado asmÃ¡tico agudo', 'Ninguna', 'Salbutamol, Corticoides intravenosos', 'Paciente con mejorÃ­a progresiva, disminuciÃ³n en requerimiento de oxÃ­geno');

INSERT INTO PATIENTS (ID, NAME, UNIT_ID, DATE_OF_BIRTH, GENDER, ADMISSION_DATE, ROOM_NUMBER, DIAGNOSIS, ALLERGIES, MEDICATIONS, NOTES)
VALUES ('pat-004', 'Miguel HernÃ¡ndez', 'unit-1', TO_DATE('2009-05-30', 'YYYY-MM-DD'), 'Male', SYSTIMESTAMP - 7, '204', 'Trauma craneoencefÃ¡lico moderado', 'LÃ¡tex', 'Manitol, AnalgÃ©sicos', 'Glasgow 12/15, pupilas isocÃ³ricas, requiere monitoreo neurolÃ³gico frecuente');

INSERT INTO PATIENTS (ID, NAME, UNIT_ID, DATE_OF_BIRTH, GENDER, ADMISSION_DATE, ROOM_NUMBER, DIAGNOSIS, ALLERGIES, MEDICATIONS, NOTES)
VALUES ('pat-005', 'Isabella GonzÃ¡lez', 'unit-1', TO_DATE('2011-09-14', 'YYYY-MM-DD'), 'Female', SYSTIMESTAMP - 4, '205', 'Insuficiencia respiratoria aguda', 'Iodo', 'VentilaciÃ³n mecÃ¡nica, Sedantes', 'Paciente intubado, parÃ¡metros ventilatorios estables');

INSERT INTO PATIENTS (ID, NAME, UNIT_ID, DATE_OF_BIRTH, GENDER, ADMISSION_DATE, ROOM_NUMBER, DIAGNOSIS, ALLERGIES, MEDICATIONS, NOTES)
VALUES ('pat-006', 'David PÃ©rez', 'unit-1', TO_DATE('2013-01-25', 'YYYY-MM-DD'), 'Male', SYSTIMESTAMP - 6, '206', 'Choque sÃ©ptico', 'Ninguna', 'AntibiÃ³ticos de amplio espectro, Fluidos', 'Paciente en shock distributivo, requiere soporte vasopresor');

INSERT INTO PATIENTS (ID, NAME, UNIT_ID, DATE_OF_BIRTH, GENDER, ADMISSION_DATE, ROOM_NUMBER, DIAGNOSIS, ALLERGIES, MEDICATIONS, NOTES)
VALUES ('pat-007', 'Sofia MartÃ­nez', 'unit-1', TO_DATE('2007-12-03', 'YYYY-MM-DD'), 'Female', SYSTIMESTAMP - 1, '207', 'Meningitis bacteriana', 'Penicilina', 'Ceftriaxona, Dexametasona', 'Paciente con mejorÃ­a clÃ­nica, cultivos pendientes');

INSERT INTO PATIENTS (ID, NAME, UNIT_ID, DATE_OF_BIRTH, GENDER, ADMISSION_DATE, ROOM_NUMBER, DIAGNOSIS, ALLERGIES, MEDICATIONS, NOTES)
VALUES ('pat-008', 'JosÃ© SÃ¡nchez', 'unit-1', TO_DATE('2014-06-18', 'YYYY-MM-DD'), 'Male', SYSTIMESTAMP - 8, '208', 'Quemaduras de segundo grado', 'Ninguna', 'AnalgÃ©sicos, AntibiÃ³ticos tÃ³picos', 'Quemaduras en 25% superficie corporal, requiere curas diarias');

INSERT INTO PATIENTS (ID, NAME, UNIT_ID, DATE_OF_BIRTH, GENDER, ADMISSION_DATE, ROOM_NUMBER, DIAGNOSIS, ALLERGIES, MEDICATIONS, NOTES)
VALUES ('pat-009', 'Carmen DÃ­az', 'unit-1', TO_DATE('2010-08-12', 'YYYY-MM-DD'), 'Female', SYSTIMESTAMP - 9, '209', 'Convulsiones febriles', 'Ninguna', 'AntiepilÃ©pticos, AntipirÃ©ticos', 'Paciente estable, sin recurrencia de convulsiones');

INSERT INTO PATIENTS (ID, NAME, UNIT_ID, DATE_OF_BIRTH, GENDER, ADMISSION_DATE, ROOM_NUMBER, DIAGNOSIS, ALLERGIES, MEDICATIONS, NOTES)
VALUES ('pat-010', 'Antonio Moreno', 'unit-1', TO_DATE('2006-04-07', 'YYYY-MM-DD'), 'Male', SYSTIMESTAMP - 12, '210', 'IntoxicaciÃ³n medicamentosa', 'Aspirina', 'CarbÃ³n activado, Soporte vital', 'Paciente estabilizado, requiere monitoreo de funciÃ³n hepÃ¡tica');

INSERT INTO PATIENTS (ID, NAME, UNIT_ID, DATE_OF_BIRTH, GENDER, ADMISSION_DATE, ROOM_NUMBER, DIAGNOSIS, ALLERGIES, MEDICATIONS, NOTES)
VALUES ('pat-011', 'Elena JimÃ©nez', 'unit-1', TO_DATE('2012-02-28', 'YYYY-MM-DD'), 'Female', SYSTIMESTAMP - 3, '211', 'Hipoglucemia severa', 'Ninguna', 'Glucosa intravenosa, Insulina', 'Episodio resuelto, requiere educaciÃ³n diabÃ©tica');

INSERT INTO PATIENTS (ID, NAME, UNIT_ID, DATE_OF_BIRTH, GENDER, ADMISSION_DATE, ROOM_NUMBER, DIAGNOSIS, ALLERGIES, MEDICATIONS, NOTES)
VALUES ('pat-012', 'Francisco Ruiz', 'unit-1', TO_DATE('2008-10-19', 'YYYY-MM-DD'), 'Male', SYSTIMESTAMP - 5, '212', 'Trauma abdominal', 'Ninguna', 'AnalgÃ©sicos, AntibiÃ³ticos profilÃ¡cticos', 'Paciente estable, sin signos de peritonitis');

-- Insertar Pacientes para Unidad 2 (PediatrÃ­a General) - 12 pacientes
INSERT INTO PATIENTS (ID, NAME, UNIT_ID, DATE_OF_BIRTH, GENDER, ADMISSION_DATE, ROOM_NUMBER, DIAGNOSIS, ALLERGIES, MEDICATIONS, NOTES)
VALUES ('pat-013', 'LucÃ­a Ãlvarez', 'unit-2', TO_DATE('2015-03-12', 'YYYY-MM-DD'), 'Female', SYSTIMESTAMP - 2, '301', 'Bronquiolitis', 'Ninguna', 'Salbutamol, HidrataciÃ³n', 'Paciente con mejorÃ­a respiratoria, buena respuesta al tratamiento');

INSERT INTO PATIENTS (ID, NAME, UNIT_ID, DATE_OF_BIRTH, GENDER, ADMISSION_DATE, ROOM_NUMBER, DIAGNOSIS, ALLERGIES, MEDICATIONS, NOTES)
VALUES ('pat-014', 'Pablo Romero', 'unit-2', TO_DATE('2011-07-08', 'YYYY-MM-DD'), 'Male', SYSTIMESTAMP - 1, '302', 'Gastroenteritis aguda', 'Ninguna', 'RehidrataciÃ³n oral, OndansetrÃ³n', 'Paciente con buena tolerancia oral, sin vÃ³mitos');

INSERT INTO PATIENTS (ID, NAME, UNIT_ID, DATE_OF_BIRTH, GENDER, ADMISSION_DATE, ROOM_NUMBER, DIAGNOSIS, ALLERGIES, MEDICATIONS, NOTES)
VALUES ('pat-015', 'Valentina Navarro', 'unit-2', TO_DATE('2013-11-25', 'YYYY-MM-DD'), 'Female', SYSTIMESTAMP - 3, '303', 'Otitis media aguda', 'Amoxicilina', 'Amoxicilina oral, AnalgÃ©sicos', 'Paciente afebril, disminuciÃ³n del dolor otolÃ³gico');

INSERT INTO PATIENTS (ID, NAME, UNIT_ID, DATE_OF_BIRTH, GENDER, ADMISSION_DATE, ROOM_NUMBER, DIAGNOSIS, ALLERGIES, MEDICATIONS, NOTES)
VALUES ('pat-016', 'Diego Torres', 'unit-2', TO_DATE('2009-09-14', 'YYYY-MM-DD'), 'Male', SYSTIMESTAMP - 4, '304', 'NeumonÃ­a adquirida en comunidad', 'Ninguna', 'Amoxicilina, Broncodilatadores', 'Paciente afebril, mejorÃ­a radiolÃ³gica en progreso');

INSERT INTO PATIENTS (ID, NAME, UNIT_ID, DATE_OF_BIRTH, GENDER, ADMISSION_DATE, ROOM_NUMBER, DIAGNOSIS, ALLERGIES, MEDICATIONS, NOTES)
VALUES ('pat-017', 'Marta RamÃ­rez', 'unit-2', TO_DATE('2014-05-30', 'YYYY-MM-DD'), 'Female', SYSTIMESTAMP - 2, '305', 'InfecciÃ³n urinaria', 'Sulfonamidas', 'Cefuroxima, AnalgÃ©sicos', 'Urocultivo positivo, tratamiento dirigido iniciado');

INSERT INTO PATIENTS (ID, NAME, UNIT_ID, DATE_OF_BIRTH, GENDER, ADMISSION_DATE, ROOM_NUMBER, DIAGNOSIS, ALLERGIES, MEDICATIONS, NOTES)
VALUES ('pat-018', 'AdriÃ¡n Gil', 'unit-2', TO_DATE('2010-12-03', 'YYYY-MM-DD'), 'Male', SYSTIMESTAMP - 5, '306', 'Fractura de antebrazo', 'CodeÃ­na', 'Ibuprofeno, InmovilizaciÃ³n', 'Fractura simple, alineaciÃ³n adecuada lograda');

INSERT INTO PATIENTS (ID, NAME, UNIT_ID, DATE_OF_BIRTH, GENDER, ADMISSION_DATE, ROOM_NUMBER, DIAGNOSIS, ALLERGIES, MEDICATIONS, NOTES)
VALUES ('pat-019', 'Clara Serrano', 'unit-2', TO_DATE('2012-08-17', 'YYYY-MM-DD'), 'Female', SYSTIMESTAMP - 1, '307', 'Varicela', 'Ninguna', 'AntihistamÃ­nicos, AntipirÃ©ticos', 'Lesiones en fase de costra, prurito controlado');

INSERT INTO PATIENTS (ID, NAME, UNIT_ID, DATE_OF_BIRTH, GENDER, ADMISSION_DATE, ROOM_NUMBER, DIAGNOSIS, ALLERGIES, MEDICATIONS, NOTES)
VALUES ('pat-020', 'Hugo Castro', 'unit-2', TO_DATE('2016-01-22', 'YYYY-MM-DD'), 'Male', SYSTIMESTAMP - 3, '308', 'DeshidrataciÃ³n moderada', 'Ninguna', 'RehidrataciÃ³n intravenosa', 'Paciente hidratado, buena diuresis');

INSERT INTO PATIENTS (ID, NAME, UNIT_ID, DATE_OF_BIRTH, GENDER, ADMISSION_DATE, ROOM_NUMBER, DIAGNOSIS, ALLERGIES, MEDICATIONS, NOTES)
VALUES ('pat-021', 'Natalia Rubio', 'unit-2', TO_DATE('2013-04-09', 'YYYY-MM-DD'), 'Female', SYSTIMESTAMP - 6, '309', 'Apendicitis aguda', 'Ninguna', 'AntibiÃ³ticos, AnalgÃ©sicos', 'Paciente postoperatorio, evoluciÃ³n favorable');

INSERT INTO PATIENTS (ID, NAME, UNIT_ID, DATE_OF_BIRTH, GENDER, ADMISSION_DATE, ROOM_NUMBER, DIAGNOSIS, ALLERGIES, MEDICATIONS, NOTES)
VALUES ('pat-022', 'IvÃ¡n Ortega', 'unit-2', TO_DATE('2008-11-14', 'YYYY-MM-DD'), 'Male', SYSTIMESTAMP - 2, '310', 'Asma agudizada', 'Ninguna', 'Salbutamol, Corticoides', 'Paciente con buen control sintomÃ¡tico');

INSERT INTO PATIENTS (ID, NAME, UNIT_ID, DATE_OF_BIRTH, GENDER, ADMISSION_DATE, ROOM_NUMBER, DIAGNOSIS, ALLERGIES, MEDICATIONS, NOTES)
VALUES ('pat-023', 'Paula Delgado', 'unit-2', TO_DATE('2011-06-27', 'YYYY-MM-DD'), 'Female', SYSTIMESTAMP - 7, '311', 'Faringoamigdalitis', 'Penicilina', 'Azitromicina, AnalgÃ©sicos', 'Paciente afebril, mejorÃ­a de odinofagia');

INSERT INTO PATIENTS (ID, NAME, UNIT_ID, DATE_OF_BIRTH, GENDER, ADMISSION_DATE, ROOM_NUMBER, DIAGNOSIS, ALLERGIES, MEDICATIONS, NOTES)
VALUES ('pat-024', 'Mario Guerrero', 'unit-2', TO_DATE('2014-02-11', 'YYYY-MM-DD'), 'Male', SYSTIMESTAMP - 4, '312', 'Traumatismo craneoencefÃ¡lico leve', 'Ninguna', 'AnalgÃ©sicos, ObservaciÃ³n', 'Glasgow 15/15, paciente asintomÃ¡tico');

-- Insertar Pacientes para Unidad 3 (PediatrÃ­a Especializada) - 11 pacientes
INSERT INTO PATIENTS (ID, NAME, UNIT_ID, DATE_OF_BIRTH, GENDER, ADMISSION_DATE, ROOM_NUMBER, DIAGNOSIS, ALLERGIES, MEDICATIONS, NOTES)
VALUES ('pat-025', 'Laura Flores', 'unit-3', TO_DATE('2009-07-05', 'YYYY-MM-DD'), 'Female', SYSTIMESTAMP - 10, '401', 'CardiopatÃ­a congÃ©nita', 'Ninguna', 'Digoxina, DiurÃ©ticos', 'Paciente compensado, requiere seguimiento cardiolÃ³gico');

INSERT INTO PATIENTS (ID, NAME, UNIT_ID, DATE_OF_BIRTH, GENDER, ADMISSION_DATE, ROOM_NUMBER, DIAGNOSIS, ALLERGIES, MEDICATIONS, NOTES)
VALUES ('pat-026', 'Ãlvaro Vargas', 'unit-3', TO_DATE('2010-12-18', 'YYYY-MM-DD'), 'Male', SYSTIMESTAMP - 8, '402', 'Diabetes mellitus tipo 1', 'Ninguna', 'Insulina, Control glucÃ©mico', 'Buen control metabÃ³lico, educaciÃ³n diabÃ©tica en progreso');

INSERT INTO PATIENTS (ID, NAME, UNIT_ID, DATE_OF_BIRTH, GENDER, ADMISSION_DATE, ROOM_NUMBER, DIAGNOSIS, ALLERGIES, MEDICATIONS, NOTES)
VALUES ('pat-027', 'Cristina Medina', 'unit-3', TO_DATE('2007-09-23', 'YYYY-MM-DD'), 'Female', SYSTIMESTAMP - 15, '403', 'Fibrosis quÃ­stica', 'Ninguna', 'AntibiÃ³ticos, Enzimas pancreÃ¡ticas', 'Paciente estable, requiere fisioterapia respiratoria');

INSERT INTO PATIENTS (ID, NAME, UNIT_ID, DATE_OF_BIRTH, GENDER, ADMISSION_DATE, ROOM_NUMBER, DIAGNOSIS, ALLERGIES, MEDICATIONS, NOTES)
VALUES ('pat-028', 'Sergio Herrera', 'unit-3', TO_DATE('2012-04-30', 'YYYY-MM-DD'), 'Male', SYSTIMESTAMP - 6, '404', 'Trastorno del espectro autista', 'Ninguna', 'No farmacolÃ³gico', 'Paciente en programa de intervenciÃ³n temprana');

INSERT INTO PATIENTS (ID, NAME, UNIT_ID, DATE_OF_BIRTH, GENDER, ADMISSION_DATE, ROOM_NUMBER, DIAGNOSIS, ALLERGIES, MEDICATIONS, NOTES)
VALUES ('pat-029', 'Alicia Castro', 'unit-3', TO_DATE('2011-08-14', 'YYYY-MM-DD'), 'Female', SYSTIMESTAMP - 12, '405', 'Epilepsia refractaria', 'Ninguna', 'AntiepilÃ©pticos mÃºltiples', 'Paciente con control parcial de convulsiones');

INSERT INTO PATIENTS (ID, NAME, UNIT_ID, DATE_OF_BIRTH, GENDER, ADMISSION_DATE, ROOM_NUMBER, DIAGNOSIS, ALLERGIES, MEDICATIONS, NOTES)
VALUES ('pat-030', 'Roberto Vega', 'unit-3', TO_DATE('2008-03-07', 'YYYY-MM-DD'), 'Male', SYSTIMESTAMP - 20, '406', 'Leucemia linfoblÃ¡stica aguda', 'Ninguna', 'Quimioterapia, Soporte', 'Paciente en protocolo de tratamiento oncolÃ³gico');

INSERT INTO PATIENTS (ID, NAME, UNIT_ID, DATE_OF_BIRTH, GENDER, ADMISSION_DATE, ROOM_NUMBER, DIAGNOSIS, ALLERGIES, MEDICATIONS, NOTES)
VALUES ('pat-031', 'Beatriz LeÃ³n', 'unit-3', TO_DATE('2013-11-29', 'YYYY-MM-DD'), 'Female', SYSTIMESTAMP - 9, '407', 'SÃ­ndrome de Down con cardiopatÃ­a', 'Ninguna', 'Medicamentos cardÃ­acos', 'Paciente compensado hemodinÃ¡micamente');

INSERT INTO PATIENTS (ID, NAME, UNIT_ID, DATE_OF_BIRTH, GENDER, ADMISSION_DATE, ROOM_NUMBER, DIAGNOSIS, ALLERGIES, MEDICATIONS, NOTES)
VALUES ('pat-032', 'Manuel PeÃ±a', 'unit-3', TO_DATE('2006-06-12', 'YYYY-MM-DD'), 'Male', SYSTIMESTAMP - 25, '408', 'ParÃ¡lisis cerebral', 'Ninguna', 'AntiespÃ¡sticos, Fisioterapia', 'Paciente en programa de rehabilitaciÃ³n intensiva');

INSERT INTO PATIENTS (ID, NAME, UNIT_ID, DATE_OF_BIRTH, GENDER, ADMISSION_DATE, ROOM_NUMBER, DIAGNOSIS, ALLERGIES, MEDICATIONS, NOTES)
VALUES ('pat-033', 'Silvia CortÃ©s', 'unit-3', TO_DATE('2014-01-16', 'YYYY-MM-DD'), 'Female', SYSTIMESTAMP - 7, '409', 'Prematuridad extrema', 'Ninguna', 'NutriciÃ³n especializada, Soporte respiratorio', 'Paciente en seguimiento de desarrollo neurolÃ³gico');

INSERT INTO PATIENTS (ID, NAME, UNIT_ID, DATE_OF_BIRTH, GENDER, ADMISSION_DATE, ROOM_NUMBER, DIAGNOSIS, ALLERGIES, MEDICATIONS, NOTES)
VALUES ('pat-034', 'Fernando Aguilar', 'unit-3', TO_DATE('2010-05-03', 'YYYY-MM-DD'), 'Male', SYSTIMESTAMP - 11, '410', 'Trastorno de dÃ©ficit de atenciÃ³n', 'Ninguna', 'Estimulantes, Terapia conductual', 'Paciente con buena respuesta al tratamiento');

INSERT INTO PATIENTS (ID, NAME, UNIT_ID, DATE_OF_BIRTH, GENDER, ADMISSION_DATE, ROOM_NUMBER, DIAGNOSIS, ALLERGIES, MEDICATIONS, NOTES)
VALUES ('pat-035', 'Teresa Santana', 'unit-3', TO_DATE('2009-10-25', 'YYYY-MM-DD'), 'Female', SYSTIMESTAMP - 14, '411', 'Talasemia mayor', 'Ninguna', 'Transfusiones, Quelantes', 'Paciente en programa de trasfusiones crÃ³nicas');

-- Insertar asignaciones de usuario-paciente-turno (para crear handovers)
INSERT INTO USER_ASSIGNMENTS (ASSIGNMENT_ID, USER_ID, SHIFT_ID, PATIENT_ID, ASSIGNED_AT)
VALUES ('assign-001', 'user_demo12345678901234567890123456', 'shift-day', 'pat-001', SYSTIMESTAMP);

INSERT INTO USER_ASSIGNMENTS (ASSIGNMENT_ID, USER_ID, SHIFT_ID, PATIENT_ID, ASSIGNED_AT)
VALUES ('assign-002', 'user_demo12345678901234567890123456', 'shift-night', 'pat-002', SYSTIMESTAMP - 1);

INSERT INTO USER_ASSIGNMENTS (ASSIGNMENT_ID, USER_ID, SHIFT_ID, PATIENT_ID, ASSIGNED_AT)
VALUES ('assign-003', 'user_demo12345678901234567890123456', 'shift-day', 'pat-003', SYSTIMESTAMP - 2);

INSERT INTO USER_ASSIGNMENTS (ASSIGNMENT_ID, USER_ID, SHIFT_ID, PATIENT_ID, ASSIGNED_AT)
VALUES ('assign-004', 'user_demo12345678901234567890123456', 'shift-night', 'pat-004', SYSTIMESTAMP - 3);

INSERT INTO USER_ASSIGNMENTS (ASSIGNMENT_ID, USER_ID, SHIFT_ID, PATIENT_ID, ASSIGNED_AT)
VALUES ('assign-005', 'user_demo12345678901234567890123456', 'shift-day', 'pat-005', SYSTIMESTAMP - 4);

-- Insertar colaboradores de ejemplo
INSERT INTO CONTRIBUTORS (NAME, EMAIL, PHONE_NUMBER) VALUES ('Dra. MarÃ­a GarcÃ­a', 'maria.garcia@hospital.com.ar', '+54-11-555-0123');
INSERT INTO CONTRIBUTORS (NAME, EMAIL, PHONE_NUMBER) VALUES ('Dr. Carlos LÃ³pez', 'carlos.lopez@hospital.com.ar', '+54-11-555-0124');
INSERT INTO CONTRIBUTORS (NAME, EMAIL, PHONE_NUMBER) VALUES ('Dra. Ana MartÃ­nez', 'ana.martinez@hospital.com.ar', '+54-11-555-0125');

-- Insertar usuarios de ejemplo
INSERT INTO USERS (ID, EMAIL, FIRST_NAME, LAST_NAME, FULL_NAME, AVATAR_URL, ROLE, IS_ACTIVE, LAST_LOGIN)
VALUES ('user_demo12345678901234567890123456', 'dr.johnson@hospital.com', 'John', 'Johnson', 'Dr. John Johnson', 'https://example.com/avatar1.jpg', 'doctor', 1, SYSTIMESTAMP);

INSERT INTO USERS (ID, EMAIL, FIRST_NAME, LAST_NAME, FULL_NAME, AVATAR_URL, ROLE, IS_ACTIVE, LAST_LOGIN)
VALUES ('user_demo12345678901234567890123457', 'dr.patel@hospital.com', 'Priya', 'Patel', 'Dr. Priya Patel', 'https://example.com/avatar2.jpg', 'doctor', 1, SYSTIMESTAMP);

INSERT INTO USERS (ID, EMAIL, FIRST_NAME, LAST_NAME, FULL_NAME, AVATAR_URL, ROLE, IS_ACTIVE, LAST_LOGIN)
VALUES ('user_demo12345678901234567890123458', 'dr.martinez@hospital.com', 'Carlos', 'Martinez', 'Dr. Carlos Martinez', 'https://example.com/avatar3.jpg', 'doctor', 1, SYSTIMESTAMP);

-- Insertar preferencias de usuario
INSERT INTO USER_PREFERENCES (ID, USER_ID, THEME, LANGUAGE, TIMEZONE, NOTIFICATIONS_ENABLED, AUTO_SAVE_ENABLED)
VALUES ('pref-001', 'user_demo12345678901234567890123456', 'light', 'en', 'America/New_York', 1, 1);

INSERT INTO USER_PREFERENCES (ID, USER_ID, THEME, LANGUAGE, TIMEZONE, NOTIFICATIONS_ENABLED, AUTO_SAVE_ENABLED)
VALUES ('pref-002', 'user_demo12345678901234567890123457', 'dark', 'en', 'America/New_York', 1, 1);

INSERT INTO USER_PREFERENCES (ID, USER_ID, THEME, LANGUAGE, TIMEZONE, NOTIFICATIONS_ENABLED, AUTO_SAVE_ENABLED)
VALUES ('pref-003', 'user_demo12345678901234567890123458', 'light', 'es', 'America/New_York', 1, 1);

-- Insertar sesiones de usuario activas
INSERT INTO USER_SESSIONS (ID, USER_ID, IP_ADDRESS, USER_AGENT, IS_ACTIVE)
VALUES ('session-001', 'user_demo12345678901234567890123456', '192.168.1.100', 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36', 1);

INSERT INTO USER_SESSIONS (ID, USER_ID, IP_ADDRESS, USER_AGENT, IS_ACTIVE)
VALUES ('session-002', 'user_demo12345678901234567890123457', '192.168.1.101', 'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36', 1);

-- Insertar handover de ejemplo
INSERT INTO HANDOVERS (ID, ASSIGNMENT_ID, PATIENT_ID, STATUS, ILLNESS_SEVERITY, PATIENT_SUMMARY, SITUATION_AWARENESS_DOC_ID, SYNTHESIS, SHIFT_NAME, FROM_SHIFT_ID, TO_SHIFT_ID, FROM_DOCTOR_ID, TO_DOCTOR_ID, CREATED_BY)
VALUES ('handover-001', 'assign-001', 'pat-001', 'Active', 'Stable',
        'Paciente de 14 aÃ±os con neumonÃ­a adquirida en comunidad. Estable, saturaciÃ³n de oxÃ­geno 94%, requiere nebulizaciones cada 6 horas.',
        'doc-001',
        'Paciente estable, evoluciÃ³n favorable. Continuar tratamiento actual.',
        'MaÃ±ana â Noche', 'shift-day', 'shift-night', 'user_demo12345678901234567890123456', 'user_demo12345678901234567890123457', 'user_demo12345678901234567890123456');

-- Insertar action items del handover
INSERT INTO HANDOVER_ACTION_ITEMS (ID, HANDOVER_ID, DESCRIPTION, IS_COMPLETED)
VALUES ('action-001', 'handover-001', 'Realizar nebulizaciones cada 6 horas', 0);

INSERT INTO HANDOVER_ACTION_ITEMS (ID, HANDOVER_ID, DESCRIPTION, IS_COMPLETED)
VALUES ('action-002', 'handover-001', 'Monitorear saturaciÃ³n de oxÃ­geno', 0);

INSERT INTO HANDOVER_ACTION_ITEMS (ID, HANDOVER_ID, DESCRIPTION, IS_COMPLETED)
VALUES ('action-003', 'handover-001', 'Control de temperatura cada 4 horas', 1);

-- Insertar participantes del handover
INSERT INTO HANDOVER_PARTICIPANTS (ID, HANDOVER_ID, USER_ID, USER_NAME, USER_ROLE, STATUS)
VALUES ('participant-001', 'handover-001', 'user_demo12345678901234567890123456', 'Dr. John Johnson', 'Day Attending', 'active');

INSERT INTO HANDOVER_PARTICIPANTS (ID, HANDOVER_ID, USER_ID, USER_NAME, USER_ROLE, STATUS)
VALUES ('participant-002', 'handover-001', 'user_demo12345678901234567890123457', 'Dr. Priya Patel', 'Evening Attending', 'active');

INSERT INTO HANDOVER_PARTICIPANTS (ID, HANDOVER_ID, USER_ID, USER_NAME, USER_ROLE, STATUS)
VALUES ('participant-003', 'handover-001', 'user_demo12345678901234567890123458', 'Dr. Carlos Martinez', 'Resident', 'active');

-- Insertar secciones I-PASS del handover
INSERT INTO HANDOVER_SECTIONS (ID, HANDOVER_ID, SECTION_TYPE, CONTENT, STATUS, LAST_EDITED_BY)
VALUES ('section-001', 'handover-001', 'illness_severity', 'Stable - Paciente con evoluciÃ³n favorable', 'completed', 'user_demo12345678901234567890123456');

INSERT INTO HANDOVER_SECTIONS (ID, HANDOVER_ID, SECTION_TYPE, CONTENT, STATUS, LAST_EDITED_BY)
VALUES ('section-002', 'handover-001', 'patient_summary',
        'MarÃ­a GarcÃ­a, 14 aÃ±os, neumonÃ­a adquirida en comunidad. Ingreso hace 3 dÃ­as. Tratamiento con Amoxicilina y oxÃ­geno suplementario.',
        'completed', 'user_demo12345678901234567890123456');

INSERT INTO HANDOVER_SECTIONS (ID, HANDOVER_ID, SECTION_TYPE, CONTENT, STATUS, LAST_EDITED_BY)
VALUES ('section-003', 'handover-001', 'action_items',
        'Nebulizaciones cada 6 horas, monitoreo de saturaciÃ³n de oxÃ­geno, control de temperatura cada 4 horas',
        'in_progress', 'user_demo12345678901234567890123456');

INSERT INTO HANDOVER_SECTIONS (ID, HANDOVER_ID, SECTION_TYPE, CONTENT, STATUS, LAST_EDITED_BY)
VALUES ('section-004', 'handover-001', 'situation_awareness',
        'Paciente estable, sin complicaciones. Buena respuesta al tratamiento antibiÃ³tico.',
        'completed', 'user_demo12345678901234567890123456');

INSERT INTO HANDOVER_SECTIONS (ID, HANDOVER_ID, SECTION_TYPE, CONTENT, STATUS, LAST_EDITED_BY)
VALUES ('section-005', 'handover-001', 'synthesis',
        'Continuar tratamiento actual. Alta probable en 48-72 horas si evoluciÃ³n favorable.',
        'draft', 'user_demo12345678901234567890123456');

-- Insertar estado de sincronizaciÃ³n
INSERT INTO HANDOVER_SYNC_STATUS (ID, HANDOVER_ID, USER_ID, SYNC_STATUS, VERSION)
VALUES ('sync-001', 'handover-001', 'user_demo12345678901234567890123456', 'synced', 1);

INSERT INTO HANDOVER_SYNC_STATUS (ID, HANDOVER_ID, USER_ID, SYNC_STATUS, VERSION)
VALUES ('sync-002', 'handover-001', 'user_demo12345678901234567890123457', 'syncing', 1);

-- Insertar plantillas I-PASS
INSERT INTO IPASS_TEMPLATES (ID, TEMPLATE_ID, SECTION, TITLE, TEMPLATE_CONTENT, IS_ACTIVE)
VALUES ('template-001', 'illness-update', 'illness', 'Illness Severity Update', 'Patient condition: [condition]\nVital signs: [vitals]\nRecent changes: [changes]\nConcerns: [concerns]', 1);

INSERT INTO IPASS_TEMPLATES (ID, TEMPLATE_ID, SECTION, TITLE, TEMPLATE_CONTENT, IS_ACTIVE)
VALUES ('template-002', 'patient-summary', 'patient', 'Patient Summary Template', 'Patient: [name], [age] years old\nAdmission: [date]\nDiagnosis: [diagnosis]\nCurrent status: [status]', 1);

INSERT INTO IPASS_TEMPLATES (ID, TEMPLATE_ID, SECTION, TITLE, TEMPLATE_CONTENT, IS_ACTIVE)
VALUES ('template-003', 'action-item', 'actions', 'Action Item Template', 'Action: [action]\nPriority: [priority]\nDue: [due_date]\nResponsible: [person]', 1);

INSERT INTO IPASS_TEMPLATES (ID, TEMPLATE_ID, SECTION, TITLE, TEMPLATE_CONTENT, IS_ACTIVE)
VALUES ('template-004', 'situation-awareness', 'awareness', 'Situation Awareness Template', 'Current situation: [situation]\nTeam awareness: [awareness]\nContingency plans: [plans]', 1);

INSERT INTO IPASS_TEMPLATES (ID, TEMPLATE_ID, SECTION, TITLE, TEMPLATE_CONTENT, IS_ACTIVE)
VALUES ('template-005', 'synthesis-note', 'synthesis', 'Synthesis Note Template', 'Key takeaways: [takeaways]\nHandover to: [next_team]\nCritical information: [critical]', 1);

-- Insertar plantillas de secciones
INSERT INTO SECTION_TEMPLATES (ID, SECTION_TYPE, TEMPLATE_NAME, TEMPLATE_CONTENT, IS_DEFAULT)
VALUES ('section-template-001', 'patient_summary', 'Standard Patient Summary',
'Patient Summary:
â¢ Name: [patient_name]
â¢ Age: [patient_age]
â¢ Diagnosis: [diagnosis]
â¢ Current medications: [medications]
â¢ Allergies: [allergies]
â¢ Recent vital signs: [vitals]
â¢ Key concerns: [concerns]', 1);

INSERT INTO SECTION_TEMPLATES (ID, SECTION_TYPE, TEMPLATE_NAME, TEMPLATE_CONTENT, IS_DEFAULT)
VALUES ('section-template-002', 'situation_awareness', 'Standard Situation Awareness',
'Current Situation:
â¢ Patient location: [location]
â¢ Current interventions: [interventions]
â¢ Response to treatment: [response]
â¢ Team communication: [communication]
â¢ Equipment needs: [equipment]
â¢ Family involvement: [family]', 1);

INSERT INTO SECTION_TEMPLATES (ID, SECTION_TYPE, TEMPLATE_NAME, TEMPLATE_CONTENT, IS_DEFAULT)
VALUES ('section-template-003', 'synthesis', 'Standard Synthesis',
'Handover Synthesis:
â¢ Key clinical decisions: [decisions]
â¢ Outstanding tasks: [tasks]
â¢ Follow-up requirements: [followup]
â¢ Communication with family: [family_comm]
â¢ Discharge planning: [discharge]
â¢ Next steps: [next_steps]', 1);

-- Insertar elementos de lista de verificaciÃ³n de confirmaciÃ³n por defecto
INSERT INTO HANDOVER_CHECKLISTS (ID, HANDOVER_ID, USER_ID, ITEM_ID, ITEM_CATEGORY, ITEM_LABEL, ITEM_DESCRIPTION, IS_REQUIRED, IS_CHECKED)
VALUES ('checklist-001', 'handover-001', 'user_demo12345678901234567890123456', 'clinical-status', 'Clinical Status', 'Review clinical data', 'I have reviewed all clinical data and understand the patient''s current condition', 1, 0);

INSERT INTO HANDOVER_CHECKLISTS (ID, HANDOVER_ID, USER_ID, ITEM_ID, ITEM_CATEGORY, ITEM_LABEL, ITEM_DESCRIPTION, IS_REQUIRED, IS_CHECKED)
VALUES ('checklist-002', 'handover-001', 'user_demo12345678901234567890123456', 'medications', 'Medications', 'Understand medications', 'I understand all current medications, dosages, and administration schedules', 1, 0);

INSERT INTO HANDOVER_CHECKLISTS (ID, HANDOVER_ID, USER_ID, ITEM_ID, ITEM_CATEGORY, ITEM_LABEL, ITEM_DESCRIPTION, IS_REQUIRED, IS_CHECKED)
VALUES ('checklist-003', 'handover-001', 'user_demo12345678901234567890123456', 'allergies', 'Safety', 'Note allergies', 'I am aware of all patient allergies and have reviewed allergy protocols', 1, 0);

INSERT INTO HANDOVER_CHECKLISTS (ID, HANDOVER_ID, USER_ID, ITEM_ID, ITEM_CATEGORY, ITEM_LABEL, ITEM_DESCRIPTION, IS_REQUIRED, IS_CHECKED)
VALUES ('checklist-004', 'handover-001', 'user_demo12345678901234567890123456', 'priorities', 'Care Plan', 'Understand priorities', 'I understand the care priorities and treatment plan for this shift', 1, 0);

INSERT INTO HANDOVER_CHECKLISTS (ID, HANDOVER_ID, USER_ID, ITEM_ID, ITEM_CATEGORY, ITEM_LABEL, ITEM_DESCRIPTION, IS_REQUIRED, IS_CHECKED)
VALUES ('checklist-005', 'handover-001', 'user_demo12345678901234567890123456', 'contingency', 'Contingency', 'Aware of contingency plans', 'I am aware of all contingency plans and emergency protocols', 1, 0);

INSERT INTO HANDOVER_CHECKLISTS (ID, HANDOVER_ID, USER_ID, ITEM_ID, ITEM_CATEGORY, ITEM_LABEL, ITEM_DESCRIPTION, IS_REQUIRED, IS_CHECKED)
VALUES ('checklist-006', 'handover-001', 'user_demo12345678901234567890123456', 'communication', 'Communication', 'Know who to contact', 'I know who to contact for questions or concerns during this shift', 1, 0);

-- Insertar algunos mensajes de discusiÃ³n de ejemplo
INSERT INTO HANDOVER_MESSAGES (ID, HANDOVER_ID, USER_ID, MESSAGE_TEXT, MESSAGE_TYPE, CREATED_AT)
VALUES ('message-001', 'handover-001', 'user_demo12345678901234567890123456', 'Just reviewed the case. The heart failure seems stable today. Any concerns about the fluid balance?', 'message', SYSTIMESTAMP - INTERVAL '5' MINUTE);

INSERT INTO HANDOVER_MESSAGES (ID, HANDOVER_ID, USER_ID, MESSAGE_TEXT, MESSAGE_TYPE, CREATED_AT)
VALUES ('message-002', 'handover-001', 'user_demo12345678901234567890123457', 'Patient has been net negative 500ml today. Responded well to the lasix adjustment this morning. Current weight is down 2kg from admission.', 'message', SYSTIMESTAMP - INTERVAL '3' MINUTE);

INSERT INTO HANDOVER_MESSAGES (ID, HANDOVER_ID, USER_ID, MESSAGE_TEXT, MESSAGE_TYPE, CREATED_AT)
VALUES ('message-003', 'handover-001', 'user_demo12345678901234567890123458', 'Should we continue the current diuretic dose overnight? BUN/Cr stable at 1.2.', 'message', SYSTIMESTAMP - INTERVAL '1' MINUTE);

INSERT INTO HANDOVER_MESSAGES (ID, HANDOVER_ID, USER_ID, MESSAGE_TEXT, MESSAGE_TYPE, CREATED_AT)
VALUES ('message-004', 'handover-001', 'user_demo12345678901234567890123456', 'Agreed, let''s maintain current dose and recheck labs tomorrow morning.', 'message', SYSTIMESTAMP - INTERVAL '30' SECOND);

INSERT INTO HANDOVER_MESSAGES (ID, HANDOVER_ID, USER_ID, MESSAGE_TEXT, MESSAGE_TYPE, CREATED_AT)
VALUES ('message-005', 'handover-001', 'user_demo12345678901234567890123457', 'Family called - they want to discuss the discharge plan. Should I arrange a meeting for tomorrow?', 'message', SYSTIMESTAMP - INTERVAL '15' SECOND);

-- Insertar planes de contingencia de ejemplo
INSERT INTO HANDOVER_CONTINGENCY (ID, HANDOVER_ID, CONDITION_TEXT, ACTION_TEXT, PRIORITY, STATUS, CREATED_BY, CREATED_AT)
VALUES ('contingency-001', 'handover-001', 'If patient develops acute shortness of breath', 'Administer supplemental oxygen, call respiratory therapy, consider BIPAP, contact attending physician immediately', 'high', 'active', 'user_demo12345678901234567890123456', SYSTIMESTAMP - INTERVAL '30' MINUTE);

INSERT INTO HANDOVER_CONTINGENCY (ID, HANDOVER_ID, CONDITION_TEXT, ACTION_TEXT, PRIORITY, STATUS, CREATED_BY, CREATED_AT)
VALUES ('contingency-002', 'handover-001', 'If blood pressure drops below 90/60', 'Increase IV fluids, notify physician, consider vasopressors if unresponsive', 'high', 'active', 'user_demo12345678901234567890123457', SYSTIMESTAMP - INTERVAL '25' MINUTE);

INSERT INTO HANDOVER_CONTINGENCY (ID, HANDOVER_ID, CONDITION_TEXT, ACTION_TEXT, PRIORITY, STATUS, CREATED_BY, CREATED_AT)
VALUES ('contingency-003', 'handover-001', 'If patient complains of chest pain', 'Assess vital signs, administer nitroglycerin if appropriate, ECG within 10 minutes, call cardiology', 'high', 'planned', 'user_demo12345678901234567890123458', SYSTIMESTAMP - INTERVAL '20' MINUTE);

INSERT INTO HANDOVER_CONTINGENCY (ID, HANDOVER_ID, CONDITION_TEXT, ACTION_TEXT, PRIORITY, STATUS, CREATED_BY, CREATED_AT)
VALUES ('contingency-004', 'handover-001', 'If patient becomes confused or agitated', 'Assess for pain, medication side effects, or metabolic abnormalities. Consider haloperidol if needed.', 'medium', 'active', 'user_demo12345678901234567890123456', SYSTIMESTAMP - INTERVAL '15' MINUTE);

INSERT INTO HANDOVER_CONTINGENCY (ID, HANDOVER_ID, CONDITION_TEXT, ACTION_TEXT, PRIORITY, STATUS, CREATED_BY, CREATED_AT)
VALUES ('contingency-005', 'handover-001', 'If urine output decreases below 30ml/hour', 'Assess volume status, check bladder scan, consider foley catheter if retention suspected', 'medium', 'planned', 'user_demo12345678901234567890123457', SYSTIMESTAMP - INTERVAL '10' MINUTE);

-- Insertar registro de actividad de ejemplo
INSERT INTO HANDOVER_ACTIVITY_LOG (ID, HANDOVER_ID, USER_ID, ACTIVITY_TYPE, ACTIVITY_DESCRIPTION, SECTION_AFFECTED, METADATA, CREATED_AT)
VALUES ('activity-001', 'handover-001', 'user_demo12345678901234567890123456', 'section_updated', 'Updated illness severity section', 'illness_severity', '{"severity": "stable"}', SYSTIMESTAMP - INTERVAL '45' MINUTE);

INSERT INTO HANDOVER_ACTIVITY_LOG (ID, HANDOVER_ID, USER_ID, ACTIVITY_TYPE, ACTIVITY_DESCRIPTION, SECTION_AFFECTED, METADATA, CREATED_AT)
VALUES ('activity-002', 'handover-001', 'user_demo12345678901234567890123457', 'section_updated', 'Updated patient summary with latest vitals', 'patient_summary', '{"vitals_updated": true}', SYSTIMESTAMP - INTERVAL '30' MINUTE);

INSERT INTO HANDOVER_ACTIVITY_LOG (ID, HANDOVER_ID, USER_ID, ACTIVITY_TYPE, ACTIVITY_DESCRIPTION, SECTION_AFFECTED, METADATA, CREATED_AT)
VALUES ('activity-003', 'handover-001', 'user_demo12345678901234567890123458', 'action_item_added', 'Added action item for medication review', 'action_items', '{"action_id": "action-001"}', SYSTIMESTAMP - INTERVAL '25' MINUTE);

INSERT INTO HANDOVER_ACTIVITY_LOG (ID, HANDOVER_ID, USER_ID, ACTIVITY_TYPE, ACTIVITY_DESCRIPTION, SECTION_AFFECTED, METADATA, CREATED_AT)
VALUES ('activity-004', 'handover-001', 'user_demo12345678901234567890123456', 'message_sent', 'Sent message about fluid balance', null, '{"message_id": "message-001"}', SYSTIMESTAMP - INTERVAL '5' MINUTE);

INSERT INTO HANDOVER_ACTIVITY_LOG (ID, HANDOVER_ID, USER_ID, ACTIVITY_TYPE, ACTIVITY_DESCRIPTION, SECTION_AFFECTED, METADATA, CREATED_AT)
VALUES ('activity-005', 'handover-001', 'user_demo12345678901234567890123457', 'contingency_added', 'Added contingency plan for shortness of breath', null, '{"contingency_id": "contingency-001"}', SYSTIMESTAMP - INTERVAL '30' MINUTE);

COMMIT;

-- ========================================
-- MIGRATION/CLEANUP SCRIPTS FOR USER ASSIGNMENTS
-- ========================================

-- Script to clean up inconsistent user assignments (run if needed)
-- This removes assignments where the user_id format is inconsistent
/*
DELETE FROM USER_ASSIGNMENTS
WHERE USER_ID NOT LIKE 'user_%'  -- Remove non-Clerk format user IDs
   OR LENGTH(USER_ID) < 10;     -- Remove suspiciously short user IDs
*/

-- Script to update old demo user assignments to use consistent format
/*
UPDATE USER_ASSIGNMENTS
SET USER_ID = 'user_2demo12345678901234567890123456'
WHERE USER_ID = 'demo-user';
*/

-- Script to verify user assignment consistency
/*
SELECT
    USER_ID,
    COUNT(*) as ASSIGNMENT_COUNT,
    CASE
        WHEN USER_ID LIKE 'user_%' THEN 'Clerk Format'
        ELSE 'Other Format'
    END as USER_ID_FORMAT,
    LENGTH(USER_ID) as USER_ID_LENGTH
FROM USER_ASSIGNMENTS
GROUP BY USER_ID
ORDER BY USER_ID;
*/

-- ========================================
-- CONSULTAS DE VERIFICACIÃN
-- ========================================

-- Verificar conteos de tablas
SELECT 'UNITS' AS TABLE_NAME, COUNT(*) AS RECORD_COUNT FROM UNITS
UNION ALL
SELECT 'SHIFTS' AS TABLE_NAME, COUNT(*) AS RECORD_COUNT FROM SHIFTS
UNION ALL
SELECT 'PATIENTS' AS TABLE_NAME, COUNT(*) AS RECORD_COUNT FROM PATIENTS
UNION ALL
SELECT 'USER_ASSIGNMENTS' AS TABLE_NAME, COUNT(*) AS RECORD_COUNT FROM USER_ASSIGNMENTS
UNION ALL
SELECT 'CONTRIBUTORS' AS TABLE_NAME, COUNT(*) AS RECORD_COUNT FROM CONTRIBUTORS
UNION ALL
SELECT 'HANDOVERS' AS TABLE_NAME, COUNT(*) AS RECORD_COUNT FROM HANDOVERS
UNION ALL
SELECT 'HANDOVER_ACTION_ITEMS' AS TABLE_NAME, COUNT(*) AS RECORD_COUNT FROM HANDOVER_ACTION_ITEMS
UNION ALL
SELECT 'HANDOVER_PARTICIPANTS' AS TABLE_NAME, COUNT(*) AS RECORD_COUNT FROM HANDOVER_PARTICIPANTS
UNION ALL
SELECT 'HANDOVER_SECTIONS' AS TABLE_NAME, COUNT(*) AS RECORD_COUNT FROM HANDOVER_SECTIONS
UNION ALL
SELECT 'HANDOVER_SYNC_STATUS' AS TABLE_NAME, COUNT(*) AS RECORD_COUNT FROM HANDOVER_SYNC_STATUS
UNION ALL
SELECT 'USERS' AS TABLE_NAME, COUNT(*) AS RECORD_COUNT FROM USERS
UNION ALL
SELECT 'USER_PREFERENCES' AS TABLE_NAME, COUNT(*) AS RECORD_COUNT FROM USER_PREFERENCES
UNION ALL
SELECT 'USER_SESSIONS' AS TABLE_NAME, COUNT(*) AS RECORD_COUNT FROM USER_SESSIONS
UNION ALL
SELECT 'HANDOVER_CHECKLISTS' AS TABLE_NAME, COUNT(*) AS RECORD_COUNT FROM HANDOVER_CHECKLISTS
UNION ALL
SELECT 'HANDOVER_CONTINGENCY' AS TABLE_NAME, COUNT(*) AS RECORD_COUNT FROM HANDOVER_CONTINGENCY
UNION ALL
SELECT 'HANDOVER_MESSAGES' AS TABLE_NAME, COUNT(*) AS RECORD_COUNT FROM HANDOVER_MESSAGES
UNION ALL
SELECT 'HANDOVER_MENTIONS' AS TABLE_NAME, COUNT(*) AS RECORD_COUNT FROM HANDOVER_MENTIONS
UNION ALL
SELECT 'IPASS_TEMPLATES' AS TABLE_NAME, COUNT(*) AS RECORD_COUNT FROM IPASS_TEMPLATES
UNION ALL
SELECT 'SECTION_TEMPLATES' AS TABLE_NAME, COUNT(*) AS RECORD_COUNT FROM SECTION_TEMPLATES
UNION ALL
SELECT 'HANDOVER_ACTIVITY_LOG' AS TABLE_NAME, COUNT(*) AS RECORD_COUNT FROM HANDOVER_ACTIVITY_LOG;
